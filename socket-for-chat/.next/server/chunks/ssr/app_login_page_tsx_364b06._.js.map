{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ASUS/Documents/next-exercise-socket-chat-stuff/socket-for-chat/app/login/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { ChangeEvent, FormEvent, useEffect, useState } from \"react\";\r\nimport { BASE_API_URL } from \"../register/page\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { isThereAnyToken } from \"../services/utils\";\r\n\r\nexport default function Page() {\r\n\r\n    const [inputState, setInputState]= useState<Record<string, any>>({username: \"\", pass: \"\"});\r\n    const [error, setError]= useState({hasErrors: false, message: \"\"});\r\n\r\n    const history= useRouter();\r\n\r\n    const handleInputsChange= (event: ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n        setInputState({...inputState, [event.currentTarget.name] : event.currentTarget.value});\r\n        setError({hasErrors: false, message: \"\"});\r\n    };\r\n\r\n    const formSubmit= (event: FormEvent<HTMLFormElement>) => {\r\n        event.preventDefault();\r\n        if (inputState.username.trim()=== \"\") {\r\n            setError({\r\n                hasErrors: true,\r\n                message: \"Please enter a correct user name\"\r\n            });\r\n            return;\r\n        }\r\n        if (inputState.pass=== \"\") {\r\n            setError({\r\n                hasErrors: true,\r\n                message: \"Password field should not be empty\"\r\n            });\r\n            return;\r\n        }\r\n        console.log(inputState);\r\n\r\n        const responseBody= {\r\n            username: inputState.username,\r\n            password: inputState.pass\r\n        };\r\n        try {\r\n            fetch( BASE_API_URL + '/login', {\r\n                method: 'POST',\r\n                headers: {'Content-type': 'application/json'},\r\n                body: JSON.stringify(responseBody)\r\n            }).then(response=> {\r\n                console.log(response);\r\n                return response.json();\r\n            }).then(data=> {\r\n                console.log(data);\r\n                if (data.error) {\r\n                    setError({\r\n                        hasErrors: true,\r\n                        message: \"Invalid creadentials\"\r\n                    });\r\n                    return;\r\n                }\r\n                if (data.success) {\r\n                    console.log(\"Login successful\");\r\n                    localStorage.setItem(\"accessToken\", data.data.accessToken);\r\n                    localStorage.setItem(\"refreshToken\", data.data.refreshToken);\r\n                    localStorage.setItem(\"data\", JSON.stringify(data.data));\r\n                    history.push('/profile');\r\n                }\r\n            });\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n    };\r\n\r\n    useEffect(()=> {\r\n        if (isThereAnyToken(localStorage)) {\r\n            history.push('/');\r\n        }\r\n    }, []);\r\n\r\n    return <>\r\n        <div className=\"flex flex-col gap-8\">\r\n            <h1 className=\"text-xl text-center\">Log in into your account</h1>\r\n            <form onSubmit={formSubmit} className=\"flex flex-col gap-2 my-2\">\r\n                <input type=\"text\" name=\"username\" id=\"username\" onChange={handleInputsChange} value={inputState.username} placeholder=\"User name\" />\r\n                <input type=\"password\" name=\"pass\" id=\"pass\" onChange={handleInputsChange} value={inputState.pass} placeholder=\"User password\" />\r\n                {error.hasErrors && <p className=\"text-[#f00]\">{error.message}</p>}\r\n                <input type=\"submit\" className=\"px-4 py-1 bg-[#333] text-white hover:bg-[#55f] cursor-pointer\" value={\"Log in\"} />\r\n            </form>\r\n        </div>\r\n    </>;\r\n}"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;AAJA;;;;;;AAMe,SAAS;IAEpB,MAAM,CAAC,YAAY,cAAc,GAAE,CAAA,GAAA,oUAAA,CAAA,WAAQ,AAAD,EAAuB;QAAC,UAAU;QAAI,MAAM;IAAE;IACxF,MAAM,CAAC,OAAO,SAAS,GAAE,CAAA,GAAA,oUAAA,CAAA,WAAQ,AAAD,EAAE;QAAC,WAAW;QAAO,SAAS;IAAE;IAEhE,MAAM,UAAS,CAAA,GAAA,iQAAA,CAAA,YAAS,AAAD;IAEvB,MAAM,qBAAoB,CAAC;QACvB,cAAc;YAAC,GAAG,UAAU;YAAE,CAAC,MAAM,aAAa,CAAC,IAAI,CAAC,EAAG,MAAM,aAAa,CAAC,KAAK;QAAA;QACpF,SAAS;YAAC,WAAW;YAAO,SAAS;QAAE;IAC3C;IAEA,MAAM,aAAY,CAAC;QACf,MAAM,cAAc;QACpB,IAAI,WAAW,QAAQ,CAAC,IAAI,OAAM,IAAI;YAClC,SAAS;gBACL,WAAW;gBACX,SAAS;YACb;YACA;QACJ;QACA,IAAI,WAAW,IAAI,KAAI,IAAI;YACvB,SAAS;gBACL,WAAW;gBACX,SAAS;YACb;YACA;QACJ;QACA,QAAQ,GAAG,CAAC;QAEZ,MAAM,eAAc;YAChB,UAAU,WAAW,QAAQ;YAC7B,UAAU,WAAW,IAAI;QAC7B;QACA,IAAI;YACA,MAAO,wHAAA,CAAA,eAAY,GAAG,UAAU;gBAC5B,QAAQ;gBACR,SAAS;oBAAC,gBAAgB;gBAAkB;gBAC5C,MAAM,KAAK,SAAS,CAAC;YACzB,GAAG,IAAI,CAAC,CAAA;gBACJ,QAAQ,GAAG,CAAC;gBACZ,OAAO,SAAS,IAAI;YACxB,GAAG,IAAI,CAAC,CAAA;gBACJ,QAAQ,GAAG,CAAC;gBACZ,IAAI,KAAK,KAAK,EAAE;oBACZ,SAAS;wBACL,WAAW;wBACX,SAAS;oBACb;oBACA;gBACJ;gBACA,IAAI,KAAK,OAAO,EAAE;oBACd,QAAQ,GAAG,CAAC;oBACZ,aAAa,OAAO,CAAC,eAAe,KAAK,IAAI,CAAC,WAAW;oBACzD,aAAa,OAAO,CAAC,gBAAgB,KAAK,IAAI,CAAC,YAAY;oBAC3D,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC,KAAK,IAAI;oBACrD,QAAQ,IAAI,CAAC;gBACjB;YACJ;QACJ,EAAE,OAAO,OAAO;YACZ,QAAQ,GAAG,CAAC;QAChB;IACJ;IAEA,CAAA,GAAA,oUAAA,CAAA,YAAS,AAAD,EAAE;QACN,IAAI,CAAA,GAAA,wHAAA,CAAA,kBAAe,AAAD,EAAE,eAAe;YAC/B,QAAQ,IAAI,CAAC;QACjB;IACJ,GAAG,EAAE;IAEL,qBAAO;kBACH,cAAA,6WAAC;YAAI,WAAU;;8BACX,6WAAC;oBAAG,WAAU;8BAAsB;;;;;;8BACpC,6WAAC;oBAAK,UAAU;oBAAY,WAAU;;sCAClC,6WAAC;4BAAM,MAAK;4BAAO,MAAK;4BAAW,IAAG;4BAAW,UAAU;4BAAoB,OAAO,WAAW,QAAQ;4BAAE,aAAY;;;;;;sCACvH,6WAAC;4BAAM,MAAK;4BAAW,MAAK;4BAAO,IAAG;4BAAO,UAAU;4BAAoB,OAAO,WAAW,IAAI;4BAAE,aAAY;;;;;;wBAC9G,MAAM,SAAS,kBAAI,6WAAC;4BAAE,WAAU;sCAAe,MAAM,OAAO;;;;;;sCAC7D,6WAAC;4BAAM,MAAK;4BAAS,WAAU;4BAAgE,OAAO;;;;;;;;;;;;;;;;;;;AAItH"}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}